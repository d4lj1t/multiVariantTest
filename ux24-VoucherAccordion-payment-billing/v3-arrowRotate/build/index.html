<style>

.ux24-v3 #redeemCardsAndVouchers {
  font-size: 13px;
  font-weight: bold;
  text-decoration: none;
  display: inline;
  margin-left: 45px;
}
.ux24-v3 .pptGiftFieldset {
  display: none;
}
.ux24-v3 .pptGiftFieldset legend {
  margin-bottom: 0;
  cursor: pointer;
  line-height: 20px;
  background-color: white;
  -webkit-transition: all 0.5s ease;
  -moz-transition: all 0.5s ease;
  -ms-transition: all 0.5s ease;
  -o-transition: all 0.5s ease;
  transition: all 0.5s ease;
}
.ux24-v3 .pptGiftFieldset legend p {
  vertical-align: middle;
  line-height: 20px;
}
.ux24-v3 .pptGiftFieldset legend p:hover {
  color: black;
}
.ux24-v3 .pptGiftFieldset legend.active {
  background-color: #E2238B;
  -webkit-transition: all 0.5s ease;
  -moz-transition: all 0.5s ease;
  -ms-transition: all 0.5s ease;
  -o-transition: all 0.5s ease;
  transition: all 0.5s ease;
}
.ux24-v3 .pptGiftFieldset legend.active p {
  color: white;
}
.ux24-v3 .pptGiftFieldset legend span {
  margin-left: 15px;
  margin-right: 15px;
  float: right;
  width: 20px;
  height: 20px;
  background-image: none;
  -webkit-transform: scale(1, 1);
  -moz-transform: scale(1, 1);
  -ms-transform: scale(1, 1);
  -o-transform: scale(1, 1);
  transform: scale(1, 1);
  -webkit-transition: all 0.5s ease;
  -moz-transition: all 0.5s ease;
  -ms-transition: all 0.5s ease;
  -o-transition: all 0.5s ease;
  transition: all 0.5s ease;
}
.ux24-v3 .pptGiftFieldset legend span.active {
  background-image: none;
  -webkit-transform: scale(1, -1);
  -moz-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  -o-transform: scale(1, -1);
  transform: scale(1, -1);
}
.ux24-v3 .pptGiftFieldset legend span.active polyline {
  stroke: white;
}
.ux24-v3 h1.paymentH1 {
  padding-bottom: 15px;
  margin-bottom: 0;
}
.ux24-v3 #dwfrm_giftchecker_giftcode,
.ux24-v3 #dwfrm_pptgiftcard_cardnumber {
  display: inline-block;
  margin-top: 10px;
  margin-right: 15px;
  margin-bottom: 0;
}
.ux24-v3 #couponCodeInput {
  margin-top: 10px;
  width: 200px;
}
.ux24-v3 #redeemCardsAndVouchersContainer {
  margin-left: 75px;
  padding-bottom: 30px;
}
.ux24-v3 .section.cardsLi {
  margin-left: 20px;
}
.ux24-v3 .pptGiftFieldset {
  margin-top: 0;
  margin-bottom: 0;
}
.ux24-v3 .pptGiftFieldset legend {
  padding-bottom: 15px;
  padding-top: 15px;
}
.ux24-v3 .basket-stock-msg {
  border-bottom: solid 1px #ccc;
  padding-top: 10px;
  padding-bottom: 10px;
  margin: 0 !important;
}
.ux24-v3 #giftVoucherBtn {
  margin-bottom: 0;
}
.ux24-v3 fieldset div.success {
  vertical-align: baseline;
}
.ux24-v3 #addCouponButton {
  margin-left: 15px;
}
.ux24-v3 .voucher-terms {
  margin-bottom: 5px;
}
.ux24-v3 hr.voucher-container {
  margin-bottom: 12px;
}
.ux24-v3 .voucherCodeBtn {
  margin-top: 10px;
}
.ux24-v3 #payPalContainer {
  margin-bottom: 30px;
}

</style>
<script>
var accordionClick = false;
var inputFocus = false;

'use strict';

var HOFMaxymiser = HOFMaxymiser || {};

HOFMaxymiser.UX24_v3 = function () {

    var Settings = {
        actionName: 'ux24',
        isProduction: true          // Mark it as true after the variant is tested
    };

    Settings.varient= 'v3';


    ////// Test Starts here
    var Model = {};

    var View = {};

    View.pages = {
        MY_BAG: 0,
        DELIVERY: 1,
        PAYMENT: 2,
        SUMMARY: 3,
        COMPLETE: 4
    }

    View.getPage = function (value) {
        for (var k in View.pages) {
            if (View.pages.hasOwnProperty(k)) {
                if (View.pages[k] == value) {
                    return k;
                }
            }
        }
        return undefined;
    }

    View.findPage = function () {
        var nav = $('#progress');
        var current = nav.find('.current');
        var positionOfSelected = current.index();
        return View.getPage(positionOfSelected);
    }

    View.injectSVG = function () {
        var strVar="";
        strVar += "<svg version=\"1.1\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" x=\"0px\" y=\"0px\" width=\"20px\"";
        strVar += "	 height=\"20px\" viewBox=\"0 0 20 20\" enable-background=\"new 0 0 20 20\" xml:space=\"preserve\">";
        strVar += "<g id=\"Layer_1\">";
        strVar += "<\/g>";
        strVar += "<g id=\"Layer_3\">";
        strVar += "	<path fill=\"#FFFFFF\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M0.2,7.4\"\/>";
        strVar += "	<path fill=\"#FFFFFF\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M19.2,7.4\"\/>";
        strVar += "	<polyline fill=\"none\" stroke=\"#000000\" stroke-miterlimit=\"10\" points=\"19.8,7.2 10,13 0.2,7.2 	\"\/>";
        strVar += "<\/g>";
        strVar += "<g id=\"above_fold\" display=\"none\">";
        strVar += "<\/g>";
        strVar += "<\/svg>";


        $('.section.paymentSection legend span').append(strVar);
        $('.pptGiftFieldset').fadeIn(600);
    };

    var Controller = {};

    Controller.bindEvents = function () {
        $('#redeemCardsAndVouchers').contents().unwrap().wrap('<p id="redeemCardsAndVouchers" title="Click to Expand" />');

        $('.section.paymentSection legend').click(function () {
            if (!$(this).hasClass('active')) {
                accordionClick = true;
                mmcore.$Action(Settings.actionName, 1, 'accordionclicked');
                mmcore.request();

                $(this).addClass('active');
                $(this).find('span').addClass('active');
                $('.container-wrapper').animate({'min-height': "272px"}, 'fast');
                $('#redeemCardsAndVouchersContainer').delay(200).fadeIn({duration: 800});
            } else {
                $(this).removeClass('active');
                $(this).find('span').removeClass('active');
                $('.container-wrapper').animate({'min-height': "0"}, 'fast');
                $('#redeemCardsAndVouchersContainer').hide();
            }
        })
    };

    Controller.maxymiserTrackingEvents = function () {
        $('#dwfrm_giftchecker_giftcode, #couponCodeInput').focus(function () {
            mmcore.$Action(Settings.actionName, 1, 'inputFocus');
            mmcore.request();
            inputFocus = true;
        });

        $('#orderConfirmButton[name="dwfrm_checkout_billing_newcreditcard_confirm"]').click(function () {
            if (accordionClick === false) {
                mmcore.$Action(Settings.actionName, 1, 'submitNoAccordionClick');
                mmcore.request();
            }
        });
    };

    Controller.loadView = function () {
        if (View.findPage() === 'PAYMENT') {
            log('js-loaded-' + Settings.actionName + '-' + Settings.varient);
            document.body.classList.add(Settings.actionName + '-' + Settings.varient);
            View.injectSVG();
            $("#redeemCardsAndVouchersContainer").wrap("<div class='container-wrapper' />");
            Controller.bindEvents();
            Controller.maxymiserTrackingEvents();
        }
    };

    var log = function (textToLog) {
        if (Settings.isProduction == false) {
            console.log(textToLog);
        }
    };

    $(function () {
        Controller.loadView();
    });


    $(window).load(function () {
        if (View.findPage() === 'PAYMENT') {
            $('#redeemCardsAndVouchers, .pptGiftFieldset span').off();
        }
    });

}();




</script>

